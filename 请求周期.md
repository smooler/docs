# 请求生命周期

- [介绍](#introduction)
- [生命周期概述](#lifecycle-overview)
- [聚焦服务提供者](#focus-on-service-providers)

<a name="introduction"></a>
## 介绍

在「日常生活」中 使用任何工具时，如果理解了该工具的工作原理。那么用起来就会更加得心应手。应用开发也是如此，当你能真正懂得一个功能背后实现原理时，用起来会更加顺手，方便。

文档存在目的是为了让你更加清晰地了解 Smooler 框架是如何工作。通过框架进行全面了解，让一切都不再感觉很「神奇」。相信我，这有助于你更加清楚自己在做什么，对自己想做的事情更加胸有成竹。就算你不明白所有的术语，也不用因此失去信心！只要多一点尝试、学着如何运用，随着你浏览文档的其他部分，你的知识一定会因此增长。

<a name="lifecycle-overview"></a>
## 生命周期概述

### 首先

Smooler 应用的所有请求入口都是 `index.php` 常驻进程监听的端口号(默认9501)。而所有的请求都是经由你的 Web 服务器（Apache/Nginx）通过配置引导到这个端口。 `index.php` 文件代码并不多，但是，这里是加载框架其它部分的起点。

`index.php` 文件加载 Composer 生成的自动加载设置，然后从 HTTP 内核`app/Init.php` 类中检索 Smooler 应用程序的核心组件实例。 Smooler 本身采取的第一个动作是创建一个应用程序 / [app对象](/docs/{{version}}/app)。

### HTTP 内核

接下来， 根据进入应用程序的请求类型来将传入的请求发送到 HTTP 内核`app/Init.php`。而这个内核是用来作为所有请求都要通过的中心位置。 现在，我们先看看位于 `app/Init.php` 中的 HTTP 内核。

HTTP 内核继承了 `Smooler\Abstracts\HttpCore` 类，该类定义了一个 `app` 对象。 这个对象中的核心组件类在请求被执行前实列，这些 核心组件 配置了错误处理， 日志， 上下文内容，以及其它在请求被处理前需要执行的任务。

HTTP 内核还定义了所有请求被应用程序处理之前必须经过的 HTTP [中间件](/docs/{{version}}/middleware) ，这些中间件处理 HTTP 会话 读写、判断应用是否跨域、 参数签名验证 等等。

HTTP 内核`app` 对象的 `handle` 方法相当简单：处理上下文内容的`request` ，响应下文内容的 `response`。可以把该内核想象作一个代表整个应用的大黑盒子，处理 HTTP 请求，响应 HTTP 返回。

#### 核心组件

内核启动操作中最重要的便是你应用的核心组件了。所有应用下的核心组件均在`app` 对象中自动实例。

`app` 对象给予框架开启多种多样的组件，像数据库，单例容器，验证器，以及路由组件。只要启动核心组件就可支配框架的所有功能，所以核心组件也是 Smooler 整个引导周期最重要组成部分。


#### 请求调度

一旦启动且所有核心组件被实例，`Request` 会被递送给路由。路由将会调度请求，交给绑定的控制器，也当然包括路由绑定的中间件。

<a name="focus-on-service-providers"></a>
## 聚焦核心组件

核心组件是 Smooler 真正意义的生命周期中的关键。应用实例一旦创建，请求就被启动的应用接管。简单吧！

牢牢掌握核心组件的构建和其对 Smooler 应用处理机制的原理是非常有价值的。